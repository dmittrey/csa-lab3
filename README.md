# csa-lab3

Virtual machine and interpreter

# Описание ISA

## Типы команд

- **_Type R_**

Инструкции типа R используют три регистра
в качестве операндов: два регистра-источника
и один регистр-назначение.

| 4 бит    | 3 бит | 3 бит | 3 бит | 3 бит  |
| -------- | ----- | ----- | ----- | ------ |
| IMM[3:0] | RS2   | RS1   | RD    | OPCODE |

- **_Type I_**

Команды типа I (immediate, непосредственные)
используют два регистровых операнда и один
непосредственный операнд (константу)

| 4 бит    | 3 бит    | 3 бит | 3 бит | 3 бит  |
| -------- | -------- | ----- | ----- | ------ |
| IMM[6:3] | IMM[2:0] | RS    | RD    | OPCODE |

- **_Type S/B_**

Инструкции типа S/B (store/branch, хранение слова в памяти / условный пе- реход) используют два регистровых операнда и один не- посредственный операнд (константу)

| 4 бит    | 3 бит | 3 бит | 3 бит    | 3 бит  |
| -------- | ----- | ----- | -------- | ------ |
| IMM[6:3] | RS2   | RS1   | IMM[2:0] | OPCODE |

---

## Команды

| Тип команды | Название команды     | Назначение                     | 4 бит    | 3 бит    | 3 бит | 3 бит    | 3 бит  |
| ----------- | -------------------- | ------------------------------ | -------- | -------- | ----- | -------- | ------ |
| Type I      | ADDI reg1, reg2, IMM | reg1 = reg2 + IMM              | IMM[6:3] | IMM[2:0] | reg2  | reg1     | OPCODE |
| Type S/B    | BEQ reg1, reg2, IMM  | if (reg1 = reg2) PC = PC + IMM | IMM[6:3] | reg2     | reg1  | IMM[2:0] | OPCODE |
| Type R      | REM reg1, reg2, reg3 | reg1 = reg2 % reg3             | IMM[3:0] | reg3     | reg2  | reg1     | OPCODE |
| Type I      | MOV reg1, IMM(reg2)  | reg1 = IMM + reg2              | IMM[6:3] | IMM[2:0] | reg2  | reg1     | OPCODE |
| Type I      | LD reg1, IMM(reg2)   | reg1 = MEM(reg2 + IMM)         | IMM[6:3] | IMM[2:0] | reg2  | reg1     | OPCODE |
| Type S/B    | SW reg1, IMM(reg2)   | MEM(reg2 + IMM) = reg1         | IMM[6:3] | reg2     | reg1  | IMM[2:0] | OPCODE |
